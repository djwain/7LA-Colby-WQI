plot(splot$Year,splot$yrmed, las=1, ylim=c(0,yhigh),ylab="Median Apr. 15 - Oct. 15 CHLA (ppb)",xlab="Year")
lines(lowess(splot$Year,splot$yrmed),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
lake <- 'McGrath Pond'
MIDAS1 <- 5348
Chl <- dat %>% filter(MIDAS == MIDAS1)
# Find epicore data
ChlC <- Chl %>% filter(`Sample Type` == 'C')
# Make a month column
a <- ymd(ChlC$Date)
ChlC$Month <- month(a)
ChlC$Year <- year(a)
ChlC$Day <- day(a)
ChlC$Yday <- yday(ChlC$Date)
C <- ChlC %>% filter(Yday >= 105 & Yday <= 288)
Cavgd <- aggregate(CHLA~Year+Month+Day+Station, mean, data=C)
Cavgd$Dec <- as.character(floor(Cavgd$Year/10)*10)
Cavgd$Dec <- paste(Cavgd$Dec,'s',sep = "")
png(file="MP1_CHLA_box.png", units="in",width=5, height=5.5, res=400)
S1 <- Cavgd %>% filter(Station == 1)
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = CHLA)) +
geom_boxplot() +
labs(title = "McGrath Pond St. 1 Chlorophyll-a by Decade", y = 'ChlA (ppb)',x = '')
print(p)
dev.off()
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5348
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1)
# Load data from Colby
lake <- 'McGrath'
site <- 'MPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd(Secchi$DATE)
Secchi$Year <- year(a)
Secchi$Month <- month(a)
Secchi$Day <- day(a)
Secchi$Yday <- yday(Secchi$DATE)
S <- Secchi %>% filter(Yday >= 105 & Yday <= 288)
S <- na.omit(S)
S <- distinct(S)
S$SDT <- as.numeric(S$`SECCHI DEPTH`)
Savgd <- aggregate(SDT~Year+Month+Day+STATION, mean, data=S)
Savgd$Dec <- as.character(floor(Savgd$YEAR/10)*10)
View(Secchi)
View(Secchi)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$Year <- year(a)
Secchi$Month <- month(a)
Secchi$Day <- day(a)
Secchi$Yday <- yday(Secchi$DATE)
S <- Secchi %>% filter(Yday >= 105 & Yday <= 288)
S <- na.omit(S)
S <- distinct(S)
S$SDT <- as.numeric(S$`SECCHI DEPTH`)
Savgd <- aggregate(SDT~Year+Month+Day+STATION, mean, data=S)
Savgd$Dec <- as.character(floor(Savgd$Year/10)*10)
Savgd$Dec <- paste(Savgd$Dec,'s',sep = "")
png(file="MP1_SDT_box.png", units="in",width=5, height=5.5, res=400)
S1 <- Savgd %>% filter(STATION == 1)
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = SDT)) +
geom_boxplot() +
labs(title = "McGrath Pond St. 1 Secchi Disk Transparency by Decade", y = 'SDT (m)',x = '')
print(p)
dev.off()
View(PC)
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = SDT)) +
geom_boxplot() +
labs(title = "McGrath St. 1 Secchi Disk Transparency by Decade", y = 'SDT (m)',x = '')
print(p)
dev.off()
png(file="MP1_SDT_box.png", units="in",width=5, height=5.5, res=400)
S1 <- Savgd %>% filter(STATION == 1)
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = SDT)) +
geom_boxplot() +
labs(title = "McGrath St. 1 Secchi Disk Transparency by Decade", y = 'SDT (m)',x = '')
print(p)
dev.off()
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5348
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1)
# Load data from Colby
lake <- 'McGrath'
site <- 'MPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
# Use April 15-Oct 15
S <- Secchi %>% filter(YDAY >= 105 & YDAY <= 288)
S <- na.omit(S)
S <- distinct(S)
S$`SECCHI DEPTH` <- as.numeric(S$`SECCHI DEPTH`)
# Average data from the same day
Savgd <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+DAY+STATION, mean, data=S)
# Compute year median by station
Syr1 <- Savgd %>% filter(STATION == 1) %>% group_by(YEAR) %>% summarise(yrmed = median(`SECCHI DEPTH`))
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Syr1$yrmed)
# Plot data and trendline for each
yhigh<-max(Syr1$yrmed)+2
splot <- Syr1
st <- '1'
mk <- mk1
png(file="MP1_SDT.png", units="in",width=5, height=5.5, res=400)
smin <- round(min(splot$yrmed),1)
smean <- round(mean(splot$yrmed),1)
smed <-round(median(splot$yrmed),1)
smax <- round(max(splot$yrmed),1)
plot(splot$YEAR,splot$yrmed, las=1, ylim=c(0,yhigh),ylab="Median Apr. 15 - Oct. 15 SDT (m)",xlab="Year")
lines(lowess(splot$YEAR,splot$yrmed),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5348
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1)
# Load data from Colby
lake <- 'McGrath Pond'
site <- 'MPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
# Load data from Colby
lake <- 'McGrath'
site <- 'MPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
# Use June-Sept because they have an order of magnitude more measurements than other months
S <- Secchi #%>% filter(MONTH >= 5 & MONTH <= 10)
S <- na.omit(S)
S <- distinct(S)
S$`SECCHI DEPTH` <- 3.28*as.numeric(S$`SECCHI DEPTH`)
# Average data from the same month in the same year
Savg <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+STATION, mean, data=S)
# Compute year average by station
Syr1 <- Savg %>% filter(STATION == 1) %>% group_by(YEAR) %>% summarise(yrmean = mean(`SECCHI DEPTH`))
# Plot data and trendline for each
yhigh<-max(S$`SECCHI DEPTH`)
splot <- Syr1
png(file="MP1_SDT_all.png", units="in",width=10, height=5, res=400)
plot(year(S$DATE),S$`SECCHI DEPTH`,ylim=c(yhigh,0),pch=21,col = 'azure3',bg = 'azure3',
ylab="Water Clarity (ft)",xlab="Year")
points(Syr1$YEAR,Syr1$yrmean,ylim=c(yhigh,0),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="Water Clarity (ft)",xlab="Year")
lines(lowess(splot$YEAR,splot$yrmed),col=4)
lines(lowess(Syr1$YEAR,Syr1$yrmean),col=4)
dev.off()
View(Syr1)
library(readxl)
library(dplyr)
library(lubridate)
library(tidyr)
library(stringr)
library(ggplot2)
library(Kendall)
library(ggimage)
# Load packages
library(readxl)
library(dplyr)
library(lubridate)
library(Kendall)
# Load packages
library(readxl)
library(dplyr)
library(lubridate)
library(Kendall)
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5274
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1)
# Load data from Colby
lake <- 'Great'
site <- 'GPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
# Load data from Colby
lake <- 'Great Pond'
site <- 'GPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5274
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1)
# Load data from Colby
lake <- 'Great Pond'
site <- 'GPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
# Use April 15-Oct 15
S <- Secchi %>% filter(YDAY >= 105 & YDAY <= 288)
S <- na.omit(S)
S <- distinct(S)
S$`SECCHI DEPTH` <- as.numeric(S$`SECCHI DEPTH`)
# Average data from the same day
Savgd <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+DAY+STATION, mean, data=S)
# Compute year median by station
Syr1 <- Savgd %>% filter(STATION == 1) %>% group_by(YEAR) %>% summarise(yrmed = median(`SECCHI DEPTH`))
Syr1$ft <- Syr1$yrmed*3.28
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Syr1$ft)
sdp <- ggplot(Syr1, aes(YEAR, ft)) +
geom_point() +
labs(y = "SDT (ft)", x = "Year") +
geom_smooth(method='loess') +
scale_y_continuous(trans = 'reverse', lim = c(10,0)*3.28) +
labs(title = 'Average Great Pond Secchi Disk Transparency')
sdp <- ggplot(Syr1, aes(YEAR, ft)) +
geom_point() +
labs(y = "SDT (ft)", x = "Year") +
geom_smooth(method='loess') +
scale_y_continuous(trans = 'reverse', lim = c(10,0)*3.28) +
labs(title = 'Average Great Pond Secchi Disk Transparency')
sdp <- sdp + geom_hline(yintercept = 13.1, color = "red")
sdp + geom_hline(yintercept = 26.2, color = "green")
#labs(title = 'GP1 Secchi, May-Oct Avg, tau = -0.23, p = 0.020')
dev.print(png,paste(filepathC,"GP1 Median Secchi.png"),width = 682, res = 150)
sdp <- ggplot(Syr1, aes(YEAR, ft)) +
geom_point() +
labs(y = "SDT (ft)", x = "Year") +
geom_smooth(method='loess') +
scale_y_continuous(trans = 'reverse', lim = c(10,0)*3.28) +
labs(title = 'Median Great Pond Secchi Disk Transparency')
sdp <- sdp + geom_hline(yintercept = 13.1, color = "red")
sdp + geom_hline(yintercept = 26.2, color = "green")
#labs(title = 'GP1 Secchi, May-Oct Avg, tau = -0.23, p = 0.020')
dev.print(png,paste(filepathC,"GP1 Median Secchi.png"),width = 682, res = 150)
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
# Use April 15-Oct 15
S <- Secchi %>% filter(YDAY >= 105 & YDAY <= 288)
S <- na.omit(S)
S <- distinct(S)
S$`SECCHI DEPTH` <- as.numeric(S$`SECCHI DEPTH`)
# Average data from the same day
Savgd <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+DAY+STATION, mean, data=S)
# Compute year median by station
Syr1 <- Savgd %>% filter(STATION == 1) %>% group_by(YEAR) %>% summarise(yrmed = median(`SECCHI DEPTH`))
Syr1$ft <- Syr1$yrmed*3.28
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Syr1$ft)
sdp <- ggplot(Syr1, aes(YEAR, ft)) +
geom_point() +
labs(y = "SDT (ft)", x = "Year") +
geom_smooth(method='loess') +
scale_y_continuous(trans = 'reverse', lim = c(10,0)*3.28) +
labs(title = 'Median Great Pond Secchi Disk Transparency')
sdp <- sdp + geom_hline(yintercept = 13.1, color = "red")
sdp + geom_hline(yintercept = 26.2, color = "green")
#labs(title = 'GP1 Secchi, May-Oct Avg, tau = -0.23, p = 0.020')
dev.print(png,paste(filepathC,"GP1 Median Secchi.png"),width = 682, res = 150)
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5272
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1)
# Load data from Colby
lake <- 'Long Pond'
site <- 'LPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
# Use April 15-Oct 15
S <- Secchi %>% filter(YDAY >= 105 & YDAY <= 288)
S <- na.omit(S)
S <- distinct(S)
S$`SECCHI DEPTH` <- as.numeric(S$`SECCHI DEPTH`)
# Average data from the same day
Savgd <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+DAY+STATION, mean, data=S)
# Compute year median by station
Syr1 <- Savgd %>% filter(STATION == 1) %>% group_by(YEAR) %>% summarise(yrmed = median(`SECCHI DEPTH`))
Syr1$ft <- Syr1$yrmed*3.28
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Syr1$ft)
sdp <- ggplot(Syr1, aes(YEAR, ft)) +
geom_point() +
labs(y = "SDT (ft)", x = "Year") +
geom_smooth(method='loess') +
scale_y_continuous(trans = 'reverse', lim = c(10,0)*3.28) +
labs(title = 'Median Long-Upper Secchi Disk Transparency')
sdp <- sdp + geom_hline(yintercept = 13.1, color = "red")
sdp + geom_hline(yintercept = 26.2, color = "green")
#labs(title = 'GP1 Secchi, May-Oct Avg, tau = -0.23, p = 0.020')
dev.print(png,paste(filepathC,"LP1 Median Secchi.png"),width = 682, res = 150)
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5272
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1)
# Load data from Colby
lake <- 'Long Pond'
site <- 'LPDEP2'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 2
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
# Use April 15-Oct 15
S <- Secchi %>% filter(YDAY >= 105 & YDAY <= 288)
S <- na.omit(S)
S <- distinct(S)
S$`SECCHI DEPTH` <- as.numeric(S$`SECCHI DEPTH`)
# Average data from the same day
Savgd <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+DAY+STATION, mean, data=S)
# Compute year median by station
Syr1 <- Savgd %>% filter(STATION == 2) %>% group_by(YEAR) %>% summarise(yrmed = median(`SECCHI DEPTH`))
Syr1$ft <- Syr1$yrmed*3.28
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Syr1$ft)
sdp <- ggplot(Syr1, aes(YEAR, ft)) +
geom_point() +
labs(y = "SDT (ft)", x = "Year") +
geom_smooth(method='loess') +
scale_y_continuous(trans = 'reverse', lim = c(10,0)*3.28) +
labs(title = 'Median Long-Lower Secchi Disk Transparency')
sdp <- sdp + geom_hline(yintercept = 13.1, color = "red")
sdp + geom_hline(yintercept = 26.2, color = "green")
#labs(title = 'GP1 Secchi, May-Oct Avg, tau = -0.23, p = 0.020')
dev.print(png,paste(filepathC,"LP2 Median Secchi.png"),width = 682, res = 150)
