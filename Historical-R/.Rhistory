ylab="Water Clarity (ft)",xlab="Year",title('Long Pond North Basin'))
points(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`,ylim=c(3.28*yhigh,0),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="Water Clarity (ft)",xlab="Year")
lines(lowess(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`),col=4)
dev.off()
yhigh<-max(Savgd$`SECCHI DEPTH`) +1
png(file="LP1_SDT_all_ft.png", units="in",width=5, height=5, res=400)
plot(Savgd$YEAR,3.28*Savgd$`SECCHI DEPTH`,ylim=c(3.28*yhigh,0),pch=21,col = 'azure3',bg = 'azure3',
ylab="Water Clarity (ft)",xlab="Year",title('Long Pond North Basin'))
points(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`,ylim=c(3.28*yhigh,0),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="Water Clarity (ft)",xlab="Year")
lines(lowess(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`),col=4)
dev.off()
yhigh<-max(Savgd$`SECCHI DEPTH`) +1
png(file="LP2_SDT_all_ft.png", units="in",width=5, height=5, res=400)
plot(Savgd$YEAR,3.28*Savgd$`SECCHI DEPTH`,ylim=c(3.28*yhigh,0),pch=21,col = 'azure3',bg = 'azure3',
ylab="Water Clarity (ft)",xlab="Year",title('Long Pond South Basin'))
points(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`,ylim=c(3.28*yhigh,0),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="Water Clarity (ft)",xlab="Year")
lines(lowess(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`),col=4)
dev.off()
setwd("~/Dropbox (Personal)/My Mac (ens-helpâ€™s MacBook Pro)/Documents/GitHub/7LA-Colby-WQI/Historical-R/Long-Lower")
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5272
station <- 2
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1 & STATION == station)
# Load data from Colby
lake <- 'Long Pond'
site <- 'LPDEP2'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 2
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
# Use April 15-Oct 15
#S <- Secchi %>% filter(YDAY >= 105 & YDAY <= 288)
S <- na.omit(Secchi)
S <- distinct(S)
S$`SECCHI DEPTH` <- as.numeric(S$`SECCHI DEPTH`)
# Average data from the same day
Savgd <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+DAY, mean, data=S)
# Average data from the same month in the same year
Savgm <- aggregate(`SECCHI DEPTH`~YEAR+MONTH, mean, data=Savgd)
Savg <- aggregate(`SECCHI DEPTH`~YEAR, mean, data=Savgm)
yhigh<-max(Savgd$`SECCHI DEPTH`) +1
png(file="LP2_SDT_all_ft.png", units="in",width=5, height=5, res=400)
plot(Savgd$YEAR,3.28*Savgd$`SECCHI DEPTH`,ylim=c(3.28*yhigh,0),pch=21,col = 'azure3',bg = 'azure3',
ylab="Water Clarity (ft)",xlab="Year",title('Long Pond South Basin'))
points(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`,ylim=c(3.28*yhigh,0),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="Water Clarity (ft)",xlab="Year")
lines(lowess(Savg$YEAR,3.28*Savg$`SECCHI DEPTH`),col=4)
dev.off()
# Load packages
library(readxl)
library(dplyr)
library(lubridate)
library(Kendall)
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_pHColorCond_Alk_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
lake <- 'Long Pond'
MIDAS1 <- 5272
Chem <- dat %>% filter(MIDAS == MIDAS1 & Station == 2)
# Find epicore data
ChemC <-Chem %>% filter(`Type` == 'C')
# Make a month column
a <- ymd(ChemC$Date)
ChemC$Month <- month(a)
ChemC$Year <- year(a)
ChemC$Day <- day(a)
ChemC$Yday <- yday(ChemC$Date)
# Use Apr 15-OCt 15
C <- ChemC #%>% filter(Yday >= 105 & Yday <= 288)
# Average data from the same month in the same year
pHd <- aggregate(pH~Year+Month+Day+pH_Method, mean, data=C)
Colord <- aggregate(`Color (SPU)`~Year+Month+Day+AORT, mean, data=C)
Condd <- aggregate(`Conductivity (uS)`~Year+Month+Day+Cond_Method, mean, data=C)
Alkd <- aggregate(`Alkalinity (mg/L)`~Year+Month+Day, mean, data=C)
Alkd <- Alkd %>% filter(`Alkalinity (mg/L)` < 20)
View(Condd)
library(readxl)
library(dplyr)
library(lubridate)
library(Kendall)
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Phosphorus.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
lake <- 'Long Pond'
MIDAS1 <- 5272
Pall <- dat %>% filter(MIDAS == MIDAS1 & Station == 1)
# Find epicore data
PC <- Pall %>% filter(`Sample Type` == 'C')
# Make a month column
a <- ymd(PC$Date)
PC$Month <- month(a)
PC$Year <- year(a)
PC$Day <- day(a)
PC$Yday <- yday(PC$Date)
# Average data from the date
Pavgd <- aggregate(`Total P`~Year+Month+Day, mean, data=PC)
# Average data from the same month in the same year
Pavgm <- aggregate(`Total P`~Year+Month, mean, data=Pavgd)
Pavg <- aggregate(`Total P`~Year, mean, data=Pavgm)
View(Pavgd)
View(Pavg)
View(Pavgm)
# Get rid of May data
Pavgm2 <- Pavgm %>% filter(Pavgm$Month > 5)
View(Pavgm2)
Pavg <- aggregate(`Total P`~Year, mean, data=Pavgm2)
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Pavg$`Total P`)
# Plot data and trendline for each
yhigh<-max(Pavg$`Total P`)+3
splot <- Pavg
st <- '1'
mk <- mk1
png(file="LP1_P.png", units="in",width=5, height=5.5, res=400)
smin <- round(min(splot$`Total P`),1)
smean <- round(mean(splot$`Total P`),1)
smed <-round(median(splot$`Total P`),1)
smax <- round(max(splot$`Total P`),1)
plot(splot$Year,splot$`Total P`, las=1, ylim=c(0,yhigh),ylab="Average TP - EC (ppb)",xlab="Year")
lines(lowess(splot$Year,splot$`Total P`),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
# Do Mann Kendall trend analysis on whole time series
Pavg10 <- Pavg %>% filter(Year > 2011)
mk10<-MannKendall(Pavg10$`Total P`)
# Plot data and trendline for each
yhigh<-max(Pavg10$`Total P`)+3
splot <- Pavg10
st <- '1'
mk <- mk10
png(file="LP1_P_10.png", units="in",width=5, height=5.5, res=400)
smin <- round(min(splot$`Total P`),1)
smean <- round(mean(splot$`Total P`),1)
smed <-round(median(splot$`Total P`),1)
smax <- round(max(splot$`Total P`),1)
plot(splot$Year,splot$`Total P`, las=1, ylim=c(0,yhigh),ylab="Average TP - EC (ppb)",xlab="Year")
lines(lowess(splot$Year,splot$`Total P`),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
yhigh<-max(Pavgd$`Total P`)+3
png(file="LP1_P_all.png", units="in",width=10, height=5, res=400)
plot(Pavgd$Year,Pavgd$`Total P`,ylim=c(0,yhigh),pch=21,col = 'azure3',bg = 'azure3',
ylab="TP - EC (ppb)",xlab="Year",title('Long Pond Station 1'))
points(Pavg$Year,Pavg$`Total P`,ylim=c(0,yhigh),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="TP - EC (ppb)",xlab="Year")
dev.off()
Pavgd$Dec <- as.character(floor(Pavgd$Year/10)*10)
Pavgd$Dec <- paste(Pavgd$Dec,'s',sep = "")
png(file="LP1_P_box.png", units="in",width=5, height=5.5, res=400)
S1 <- Pavgd
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = `Total P`)) +
geom_boxplot() +
labs(title = "Long Pond St. 1 Total Phosphorus - EC by Decade", y = 'TP (ppb)',x = '')
print(p)
dev.off()
library(ggplot2)
png(file="LP1_P_box.png", units="in",width=5, height=5.5, res=400)
S1 <- Pavgd
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = `Total P`)) +
geom_boxplot() +
labs(title = "Long Pond St. 1 Total Phosphorus - EC by Decade", y = 'TP (ppb)',x = '')
print(p)
dev.off()
setwd("~/Documents/GitHub/7LA-Colby-WQI/Historical-R/Long-Lower")
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Pavg$`Total P`)
# Plot data and trendline for each
yhigh<-max(Pavg$`Total P`)+3
splot <- Pavg
st <- '1'
mk <- mk1
png(file="LP1_P.png", units="in",width=5, height=5.5, res=400)
smin <- round(min(splot$`Total P`),1)
smean <- round(mean(splot$`Total P`),1)
smed <-round(median(splot$`Total P`),1)
smax <- round(max(splot$`Total P`),1)
plot(splot$Year,splot$`Total P`, las=1, ylim=c(0,yhigh),ylab="Average TP - EC (ppb)",xlab="Year")
lines(lowess(splot$Year,splot$`Total P`),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
# Do Mann Kendall trend analysis on whole time series
Pavg10 <- Pavg %>% filter(Year > 2011)
mk10<-MannKendall(Pavg10$`Total P`)
# Plot data and trendline for each
yhigh<-max(Pavg10$`Total P`)+3
splot <- Pavg10
st <- '1'
mk <- mk10
png(file="LP1_P_10.png", units="in",width=5, height=5.5, res=400)
smin <- round(min(splot$`Total P`),1)
smean <- round(mean(splot$`Total P`),1)
smed <-round(median(splot$`Total P`),1)
smax <- round(max(splot$`Total P`),1)
plot(splot$Year,splot$`Total P`, las=1, ylim=c(0,yhigh),ylab="Average TP - EC (ppb)",xlab="Year")
lines(lowess(splot$Year,splot$`Total P`),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
yhigh<-max(Pavgd$`Total P`)+3
png(file="LP1_P_all.png", units="in",width=10, height=5, res=400)
plot(Pavgd$Year,Pavgd$`Total P`,ylim=c(0,yhigh),pch=21,col = 'azure3',bg = 'azure3',
ylab="TP - EC (ppb)",xlab="Year",title('Long Pond Station 1'))
points(Pavg$Year,Pavg$`Total P`,ylim=c(0,yhigh),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="TP - EC (ppb)",xlab="Year")
dev.off()
Pavgd$Dec <- as.character(floor(Pavgd$Year/10)*10)
Pavgd$Dec <- paste(Pavgd$Dec,'s',sep = "")
png(file="LP1_P_box.png", units="in",width=5, height=5.5, res=400)
S1 <- Pavgd
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = `Total P`)) +
geom_boxplot() +
labs(title = "Long Pond St. 1 Total Phosphorus - EC by Decade", y = 'TP (ppb)',x = '')
print(p)
dev.off()
View(Pavgd)
# Load packages
library(readxl)
library(dplyr)
library(lubridate)
library(Kendall)
library(ggplot2)
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Phosphorus.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
lake <- 'Long Pond'
MIDAS1 <- 5272
Pall <- dat %>% filter(MIDAS == MIDAS1 & Station == 2)
# Find epicore data
PC <- Pall %>% filter(`Sample Type` == 'C')
# Make a month column
a <- ymd(PC$Date)
PC$Month <- month(a)
PC$Year <- year(a)
PC$Day <- day(a)
PC$Yday <- yday(PC$Date)
# Average data from the date
Pavgd <- aggregate(`Total P`~Year+Month+Day, mean, data=PC)
# Average data from the same month in the same year
Pavgm <- aggregate(`Total P`~Year+Month, mean, data=Pavgd)
# Get rid of May data
Pavgm2 <- Pavgm %>% filter(Pavgm$Month > 5)
Pavg <- aggregate(`Total P`~Year, mean, data=Pavgm2)
# Do Mann Kendall trend analysis on whole time series
mk1<-MannKendall(Pavg$`Total P`)
# Plot data and trendline for each
yhigh<-max(Pavg$`Total P`)+3
splot <- Pavg
st <- '2'
mk <- mk1
png(file="LP2_P.png", units="in",width=5, height=5.5, res=400)
smin <- round(min(splot$`Total P`),1)
smean <- round(mean(splot$`Total P`),1)
smed <-round(median(splot$`Total P`),1)
smax <- round(max(splot$`Total P`),1)
plot(splot$Year,splot$`Total P`, las=1, ylim=c(0,yhigh),ylab="Average TP - EC (ppb)",xlab="Year")
lines(lowess(splot$Year,splot$`Total P`),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
# Do Mann Kendall trend analysis on whole time series
Pavg10 <- Pavg %>% filter(Year > 2011)
mk10<-MannKendall(Pavg10$`Total P`)
# Plot data and trendline for each
yhigh<-max(Pavg10$`Total P`)+3
splot <- Pavg10
st <- '1'
mk <- mk10
png(file="LP2_P_10.png", units="in",width=5, height=5.5, res=400)
smin <- round(min(splot$`Total P`),1)
smean <- round(mean(splot$`Total P`),1)
smed <-round(median(splot$`Total P`),1)
smax <- round(max(splot$`Total P`),1)
plot(splot$Year,splot$`Total P`, las=1, ylim=c(0,yhigh),ylab="Average TP - EC (ppb)",xlab="Year")
lines(lowess(splot$Year,splot$`Total P`),col=4)
titles<-lake
titles2<-MIDAS1
titles3<-st
mtext(text=paste(titles, "\n", " (MIDAS ",titles2," - Station ",titles3,")",sep = ""), side=3, line=1.9, font=2)
mtext(text=sprintf("tau=%1.3f",(mk$tau[1])),adj=0, side=3, line=0.6, cex=.8)
mtext(text=sprintf("p=%1.3f",(mk$sl[1])),adj=1, side=3,line=0.6, cex=.8)
mtext(text=sprintf(" min=%1.1f",smin),adj=0, side=3,line=-1, cex=.8)
mtext(text=sprintf(" mean=%1.1f",smean),adj=0, side=3,line=-2, cex=.8)
mtext(text=sprintf(" med=%1.1f",smed),adj=0, side=3,line=-3, cex=.8)
mtext(text=sprintf(" max=%1.1f",smax),adj=0, side=3,line=-4, cex=.8)
dev.off()
yhigh<-max(Pavgd$`Total P`)+3
png(file="LP2_P_all.png", units="in",width=10, height=5, res=400)
plot(Pavgd$Year,Pavgd$`Total P`,ylim=c(0,yhigh),pch=21,col = 'azure3',bg = 'azure3',
ylab="TP - EC (ppb)",xlab="Year",title('Long Pond Station 2'))
points(Pavg$Year,Pavg$`Total P`,ylim=c(0,yhigh),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="TP - EC (ppb)",xlab="Year")
dev.off()
Pavgd$Dec <- as.character(floor(Pavgd$Year/10)*10)
Pavgd$Dec <- paste(Pavgd$Dec,'s',sep = "")
png(file="LP2_P_box.png", units="in",width=5, height=5.5, res=400)
S1 <- Pavgd
# Make box plot by year and by site
p <- ggplot(data = S1, aes(x = Dec,y = `Total P`)) +
geom_boxplot() +
labs(title = "Long Pond St. 2 Total Phosphorus - EC by Decade", y = 'TP (ppb)',x = '')
print(p)
dev.off()
setwd("~/Documents/GitHub/7LA-Colby-WQI/Historical-R/Long-Upper")
library(readxl)
library(dplyr)
library(lubridate)
library(Kendall)
# Load secchi data from LSM
filepath <- "/Users/djw56/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/Belgrades/Historical/"
filename <- paste(filepath,"MaineLakes_Secchi_ByDate.xlsx",sep="")
dat <- read_excel(filename, sheet = 2)
# MIDAS is identifier for LSM data
MIDAS1 <- 5272
station <- 1
SDT_LSM <- dat %>% filter(`Lake Code (MIDAS)` == MIDAS1 & STATION == station)
# Load data from Colby
lake <- 'Long Pond'
site <- 'LPDEP1'
years <- 2015:2021
filepathC <- paste("~/Documents/Research/7LA-Colby/Belgrade Lakes/Lakes/",lake,sep="","/Transparency/")
filename1 <- paste(filepathC,site,sep=""," - Secchi 2015-2021.xlsx")
dat1 <- ""
for(i in 1:length(years)){
temp <- read_xlsx(filename1, sheet = as.character(years[i]))
temp$Date <- as.character(temp$Date)
dat1 <- rbind(dat1,temp)
}
dat1 <- dat1[-1,]
dat1$STATION <- 1
Colby <- dat1
Colby <- Colby %>% rename('DATE'='Date','SECCHI DEPTH'='Depth(m)')
LSM <- select(SDT_LSM,'DATE','SECCHI DEPTH','STATION')
Secchi <- rbind.data.frame(LSM,Colby)
a = ymd_hms(Secchi$DATE)
Secchi$YEAR <- year(a)
Secchi$MONTH <- month(a)
Secchi$DAY <- day(a)
Secchi$YDAY <- yday(Secchi$DATE)
# Use April 15-Oct 15
#S <- Secchi %>% filter(YDAY >= 105 & YDAY <= 288)
S <- na.omit(Secchi)
S <- distinct(S)
S$`SECCHI DEPTH` <- as.numeric(S$`SECCHI DEPTH`)
# Average data from the same day
Savgd <- aggregate(`SECCHI DEPTH`~YEAR+MONTH+DAY, mean, data=S)
# Average data from the same month in the same year
Savgm <- aggregate(`SECCHI DEPTH`~YEAR+MONTH, mean, data=Savgd)
Savg <- aggregate(`SECCHI DEPTH`~YEAR, mean, data=Savgm)
yhigh<-max(Savgd$`SECCHI DEPTH`) +1
png(file="LP1_SDT_all.png", units="in",width=5, height=5, res=400)
plot(Savgd$YEAR,Savgd$`SECCHI DEPTH`,ylim=c(yhigh,0),pch=21,col = 'azure3',bg = 'azure3',
ylab="SDT (m)",xlab="Year",title('Long Pond Station 1'))
points(Savg$YEAR,Savg$`SECCHI DEPTH`,ylim=c(yhigh,0),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="SDT (m)",xlab="Year")
dev.off()
yhigh<-max(Savgd$`SECCHI DEPTH`) +1
png(file="LP1_SDT_all.png", units="in",width=5, height=5, res=400)
plot(Savgd$YEAR,Savgd$`SECCHI DEPTH`,ylim=c(yhigh,0),pch=21,col = 'azure3',bg = 'azure3',
ylab="SDT (m)",xlab="Year",title('Long Pond Station 1'))
points(Savg$YEAR,Savg$`SECCHI DEPTH`,ylim=c(yhigh,0),pch=21,cex = 1.5,bg = 'aquamarine3',ylab="SDT (m)",xlab="Year")
lines(lowess(Savg$YEAR,Savg$`SECCHI DEPTH`),col=4)
dev.off()
View(SDT_LSM)
100000/7
library(tidyverse)
library(broom)
library(readxl)
library(ggplot2)
library(rpart)
library(rpart.plot)
library(party)
library(randomForest)
library(GGally)
library(ggparty)
library(caTools)
load("ME_daily_metrics.Rda")
setwd("~/Documents/GitHub/7LA-Colby-WQI/Historical-R/Maine Lakes")
load("ME_daily_metrics.Rda")
# Find shallow lakes that bloom
# Add morphological info
filepath <- "/Users/djw56/Dropbox (Personal)/Belgrade Lakes Stats/Maine Lake Data/"
filename <- paste(filepath,"MaineLakes_Geography_Morphometry.xls",sep="")
Morph <- read_excel(filename, sheet = 2)
colnames(Morph)[1] <- "midas"
Morph1 <- Morph
WQ6 <- WQ5 %>%
group_by(midas, year) %>%
summarize(zsmin = min(zS_m, na.rm = TRUE),
zs01 = as.numeric(quantile(zS_m, c(0.01), na.rm = TRUE)),
Ts = median(Ts_C, na.rm = TRUE),
Tb = median(Ts_C, na.rm = TRUE),
zT = median(zT_m, na.rm = TRUE),
zhypox = median(zhypox_m, na.rm = TRUE),
zanox = median(zanox_m, na.rm = TRUE),
Ps = median(Ps_ppb, na.rm = TRUE),
Pb = median(Pb_ppb, na.rm = TRUE),
strat_on = yday[min(which(!is.na(zT_m)))],
strat_off = yday[max(which(!is.na(zT_m)))],
strat_days = strat_off-strat_on,
hypox_on = yday[min(which(!is.na(zhypox_m)))],
hypox_off = yday[max(which(!is.na(zhypox_m)))],
hypox_days = hypox_off-hypox_on,
anox_on = yday[min(which(!is.na(zanox_m)))],
anox_off = yday[max(which(!is.na(zanox_m)))],
anox_days = anox_off-anox_on
)
View(WQ6)
WQ6 <- WQ5 %>%
group_by(midas, year) %>%
summarize(zsmed = median(zS_m, na.rm = TRUE),
zsmin = min(zS_m, na.rm = TRUE),
zs01 = as.numeric(quantile(zS_m, c(0.01), na.rm = TRUE)),
Ts = median(Ts_C, na.rm = TRUE),
Tb = median(Ts_C, na.rm = TRUE),
zT = median(zT_m, na.rm = TRUE),
zhypox = median(zhypox_m, na.rm = TRUE),
zanox = median(zanox_m, na.rm = TRUE),
Ps = median(Ps_ppb, na.rm = TRUE),
Pb = median(Pb_ppb, na.rm = TRUE),
strat_on = yday[min(which(!is.na(zT_m)))],
strat_off = yday[max(which(!is.na(zT_m)))],
strat_days = strat_off-strat_on,
hypox_on = yday[min(which(!is.na(zhypox_m)))],
hypox_off = yday[max(which(!is.na(zhypox_m)))],
hypox_days = hypox_off-hypox_on,
anox_on = yday[min(which(!is.na(zanox_m)))],
anox_off = yday[max(which(!is.na(zanox_m)))],
anox_days = anox_off-anox_on
)
View(WQ6)
plot(WQ6$zsmed,WQ$zT)
ggplot(WQ6, aes(x=zsmed, y=zT)) +
geom_point()
View(WQ6)
ggplot(WQ6, aes(x=zsmed, y=zhypox)) +
geom_point()
ggplot(WQ6, aes(x=zsmed, y=zT)) +
geom_point()
ggplot(WQ6, aes(x=zsmed, y=zT)) +
geom_point() +
geom_smooth(method=lm , color="red", se=FALSE)
write.csv(WQ5)
write.csv(WQ5,'ME_Lakes_Daily',rows = TRUE)
write.csv(WQ5,'ME_Lakes_Daily.csv',row.names= TRUE)
write.csv(WQ6,'ME_Lakes_Yearly.csv',row.names= TRUE)
